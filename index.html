<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…‰ä¼å‘ç”µé‡ä¸æ•ˆç›Šåˆ†æç³»ç»Ÿ</title>
    <meta name="description" content="ä¸“ä¸šçš„å…‰ä¼å‘ç”µé‡é¢„æµ‹å’Œç»æµæ•ˆç›Šåˆ†æå·¥å…·ï¼Œå¸®åŠ©æ‚¨è¯„ä¼°å¤ªé˜³èƒ½æŠ•èµ„å›æŠ¥">
    <meta name="keywords" content="å…‰ä¼å‘ç”µ,å¤ªé˜³èƒ½,å‘ç”µé‡é¢„æµ‹,ç»æµæ•ˆç›Šåˆ†æ,æŠ•èµ„å›æŠ¥">
    
    <!-- å¼•å…¥Chart.jså’Œå…¶ä»–å¤–éƒ¨èµ„æº -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* å…¨å±€é‡ç½®å’ŒåŸºç¡€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* é¢œè‰²ä¸»é¢˜ - ç§‘æŠ€æ„Ÿè“ç»¿è‰²è°ƒ */
            --primary-color: #0ea5e9;
            --primary-hover: #0284c7;
            --primary-light: #38bdf8;
            --secondary-color: #10b981;
            --secondary-hover: #059669;
            --accent-color: #f59e0b;
            --accent-hover: #d97706;
            
            /* çŠ¶æ€é¢œè‰² */
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: #3b82f6;
            
            /* èƒŒæ™¯å’Œè¡¨é¢é¢œè‰² */
            --background-color: #f8fafc;
            --background-gradient: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            --surface-color: #ffffff;
            --surface-hover: #f1f5f9;
            --border-color: #e2e8f0;
            --border-light: #f1f5f9;
            
            /* æ–‡å­—é¢œè‰² */
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --text-light: #cbd5e1;
            
            /* é—´è·ç³»ç»Ÿ */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
            --spacing-3xl: 4rem;
            
            /* åœ†è§’ç³»ç»Ÿ */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            
            /* é˜´å½±ç³»ç»Ÿ */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            
            /* æ¸å˜æ•ˆæœ */
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), #34d399);
            --gradient-card: linear-gradient(135deg, #ffffff, #f8fafc);
        }

        /* åŸºç¡€æ ·å¼ */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--background-gradient);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--spacing-lg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* å¤´éƒ¨æ ·å¼ */
        .header {
            background: var(--gradient-primary);
            color: white;
            padding: var(--spacing-2xl) var(--spacing-xl);
            border-radius: var(--radius-xl);
            margin-bottom: var(--spacing-2xl);
            box-shadow: var(--shadow-xl);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .main-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-2xl);
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-2xl);
            align-items: start;
        }

        /* å¡ç‰‡åŸºç¡€æ ·å¼ */
        .card {
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .card-title {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            padding: var(--spacing-xl);
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .card-title i {
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        /* é¢„æµ‹åŠŸèƒ½åŒºæ ·å¼ */
        .prediction-card {
            background: var(--surface-color);
        }

        .prediction-form {
            padding: var(--spacing-2xl);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .form-group label {
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.95rem;
        }

        .form-group label i {
            color: var(--primary-color);
            width: 1.2rem;
            text-align: center;
        }

        .form-group input {
            padding: var(--spacing-md) var(--spacing-lg);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--surface-color);
            font-family: inherit;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
            transform: translateY(-1px);
        }

        .form-group input::placeholder {
            color: var(--text-muted);
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn-primary,
        .btn-secondary {
            padding: var(--spacing-lg) var(--spacing-2xl);
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            text-decoration: none;
            font-size: 1rem;
            font-family: inherit;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--gradient-secondary);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* ç»“æœå±•ç¤ºåŒºæ ·å¼ */
        .result-card {
            background: var(--surface-color);
        }

        .chart-container {
            padding: var(--spacing-xl);
            background: linear-gradient(135deg, #f8fafc, #ffffff);
            border-bottom: 1px solid var(--border-light);
        }

        #powerChart {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-md);
        }

        /* ç»æµæ•ˆç›Šå±•ç¤º */
        .benefits-section {
            padding: var(--spacing-2xl);
        }

        .benefits-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xl);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .benefits-title i {
            color: var(--secondary-color);
            font-size: 1.5rem;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-lg);
        }

        .benefit-item {
            background: linear-gradient(135deg, #f8fafc, #ffffff);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
            transition: all 0.3s ease;
        }

        .benefit-item:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-color);
        }

        .benefit-icon {
            width: 3rem;
            height: 3rem;
            background: var(--gradient-primary);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .benefit-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .benefit-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .benefit-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        /* è¾…åŠ©å·¥å…·åŒºæ ·å¼ */
        .tools-card {
            grid-column: 1 / -1;
            background: var(--surface-color);
        }

        .tools-title {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            padding: var(--spacing-xl);
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .tools-title i {
            color: var(--accent-color);
            font-size: 1.5rem;
        }

        .tools-content {
            padding: var(--spacing-2xl);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xl);
        }

        .tool-input-group {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: var(--spacing-lg);
            align-items: end;
        }

        .tool-input-group label {
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
        }

        .tool-input-group label i {
            color: var(--accent-color);
            width: 1.2rem;
        }

        .tool-input-group input {
            padding: var(--spacing-md) var(--spacing-lg);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--surface-color);
            font-family: inherit;
        }

        .tool-input-group input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
        }

        .tool-result {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid var(--accent-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
        }

        .result-icon {
            width: 3rem;
            height: 3rem;
            background: var(--accent-color);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .result-text {
            flex: 1;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .result-label {
            font-size: 1.1rem;
            color: var(--text-primary);
            font-weight: 600;
        }

        .result-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .tool-tips {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 1px solid var(--info-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
        }

        .tool-tips h4 {
            color: var(--text-primary);
            margin-bottom: var(--spacing-lg);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .tool-tips h4 i {
            color: var(--info-color);
        }

        .tool-tips ul {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .tool-tips li {
            color: var(--text-secondary);
            padding: var(--spacing-sm) 0;
            position: relative;
            padding-left: var(--spacing-xl);
            line-height: 1.5;
        }

        .tool-tips li::before {
            content: "ğŸ’¡";
            position: absolute;
            left: 0;
            top: var(--spacing-sm);
        }

        /* é¡µè„šæ ·å¼ */
        .footer {
            text-align: center;
            padding: var(--spacing-2xl);
            color: var(--text-muted);
            border-top: 1px solid var(--border-color);
            margin-top: var(--spacing-2xl);
            background: rgba(255, 255, 255, 0.5);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(10px);
        }

        /* Toast æç¤ºæ ·å¼ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 300px;
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            transform: translateX(400px);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-content {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            font-weight: 500;
        }

        .toast-success {
            background: linear-gradient(135deg, #10b981, #34d399);
            color: white;
        }

        .toast-error {
            background: linear-gradient(135deg, #ef4444, #f87171);
            color: white;
        }

        .toast-warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            color: white;
        }

        .toast-info {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .loading .benefit-value {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .container {
                max-width: 100%;
                padding: var(--spacing-md);
            }
            
            .content-grid {
                gap: var(--spacing-xl);
            }
            
            .main-title {
                font-size: 2rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-sm);
            }
            
            .content-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-lg);
            }
            
            .tool-input-group {
                grid-template-columns: 1fr;
                gap: var(--spacing-md);
            }
            
            .main-title {
                font-size: 1.75rem;
            }
            
            .header {
                padding: var(--spacing-xl);
            }
            
            .benefits-grid {
                gap: var(--spacing-md);
            }
            
            .benefit-item {
                padding: var(--spacing-md);
                gap: var(--spacing-md);
            }
            
            .benefit-icon {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 1rem;
            }
            
            .tool-result {
                flex-direction: column;
                text-align: center;
                gap: var(--spacing-md);
            }
            
            .result-text {
                flex-direction: column;
                gap: var(--spacing-sm);
            }
        }

        @media (max-width: 480px) {
            .prediction-form,
            .benefits-section,
            .tools-content {
                padding: var(--spacing-lg);
            }
            
            .main-title {
                font-size: 1.5rem;
            }
            
            .card-title {
                padding: var(--spacing-lg);
                font-size: 1.1rem;
            }
            
            .benefit-value {
                font-size: 1.1rem;
            }
            
            .btn-primary,
            .btn-secondary {
                padding: var(--spacing-md) var(--spacing-xl);
                font-size: 0.95rem;
            }
        }

        /* å¹³æ»‘æ»šåŠ¨å’ŒåŠ¨ç”» */
        html {
            scroll-behavior: smooth;
        }

        /* é€‰æ‹©æ–‡æœ¬æ ·å¼ */
        ::selection {
            background: rgba(14, 165, 233, 0.2);
            color: var(--text-primary);
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--border-light);
            border-radius: var(--radius-sm);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: var(--radius-sm);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* åŠ è½½åŠ¨ç”» */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card {
            animation: fadeIn 0.6s ease-out;
        }

        /* ç„¦ç‚¹æ ·å¼å¢å¼º */
        button:focus-visible,
        input:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* æŒ‰é’®ç¦ç”¨çŠ¶æ€ */
        .btn-primary:disabled,
        .btn-secondary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ä¸»æ ‡é¢˜ -->
        <header class="header">
            <h1 class="main-title">â˜€ï¸ å…‰ä¼å‘ç”µé‡ä¸æ•ˆç›Šåˆ†æç³»ç»Ÿ</h1>
        </header>

        <!-- ä¸»è¦å†…å®¹ -->
        <main class="main-content">
            <div class="content-grid">
                <!-- é¢„æµ‹åŠŸèƒ½åŒº -->
                <div class="card prediction-card">
                    <h2 class="card-title">
                        <i class="fas fa-solar-panel"></i>
                        é¢„æµ‹åŠŸèƒ½åŒº
                    </h2>
                    <form class="prediction-form" id="predictionForm">
                        <div class="form-group">
                            <label for="city">
                                <i class="fas fa-map-marker-alt"></i>
                                æ‰€åœ¨åŸå¸‚
                            </label>
                            <input type="text" 
                                   id="city" 
                                   name="city" 
                                   placeholder="è¯·è¾“å…¥åŸå¸‚åç§°ï¼Œå¦‚ï¼šåŒ—äº¬"
                                   value="åŒ—äº¬"
                                   required>
                        </div>

                        <div class="form-group">
                            <label for="power">
                                <i class="fas fa-bolt"></i>
                                å…‰ä¼æ¿æ€»åŠŸç‡ (kW)
                            </label>
                            <input type="number" 
                                   id="power" 
                                   name="power" 
                                   step="0.1" 
                                   min="0.1" 
                                   max="10000" 
                                   placeholder="ä¾‹å¦‚ï¼š5.0"
                                   value="5.0"
                                   required>
                        </div>

                        <div class="form-group">
                            <label for="angle">
                                <i class="fas fa-angle-up"></i>
                                å®‰è£…è§’åº¦ (åº¦)
                            </label>
                            <input type="number" 
                                   id="angle" 
                                   name="angle" 
                                   step="1" 
                                   min="0" 
                                   max="90" 
                                   placeholder="ä¾‹å¦‚ï¼š30"
                                   value="30"
                                   required>
                        </div>

                        <div class="form-group">
                            <label for="electricity_price">
                                <i class="fas fa-money-bill-wave"></i>
                                æœ¬åœ°ç”µä»· (å…ƒ/åº¦)
                            </label>
                            <input type="number" 
                                   id="electricity_price" 
                                   name="electricity_price" 
                                   step="0.01" 
                                   min="0.1" 
                                   max="5" 
                                   placeholder="ä¾‹å¦‚ï¼š0.5"
                                   value="0.5"
                                   required>
                        </div>

                        <div class="form-group">
                            <label for="system_cost">
                                <i class="fas fa-calculator"></i>
                                å…‰ä¼ç³»ç»Ÿæ€»æˆæœ¬ (å…ƒ)
                            </label>
                            <input type="number" 
                                   id="system_cost" 
                                   name="system_cost" 
                                   step="100" 
                                   min="1000" 
                                   max="10000000" 
                                   placeholder="ä¾‹å¦‚ï¼š50000"
                                   value="50000"
                                   required>
                        </div>

                        <button type="submit" class="btn-primary" id="predictBtn">
                            <i class="fas fa-chart-line"></i>
                            å¼€å§‹é¢„æµ‹
                        </button>
                    </form>
                </div>

                <!-- ç»“æœå±•ç¤ºåŒº -->
                <div class="card result-card">
                    <h2 class="card-title">
                        <i class="fas fa-chart-bar"></i>
                        ç»“æœå±•ç¤ºåŒº
                    </h2>
                    
                    <!-- å›¾è¡¨åŒºåŸŸ -->
                    <div class="chart-container">
                        <canvas id="powerChart" width="600" height="300"></canvas>
                    </div>

                    <!-- ç»æµæ•ˆç›Šå±•ç¤º -->
                    <div class="benefits-section">
                        <h3 class="benefits-title">
                            <i class="fas fa-coins"></i>
                            ç»æµæ•ˆç›Šåˆ†æ
                        </h3>
                        <div class="benefits-grid">
                            <div class="benefit-item">
                                <div class="benefit-icon">
                                    <i class="fas fa-battery-full"></i>
                                </div>
                                <div class="benefit-content">
                                    <span class="benefit-label">æ—¥å‡æ€»å‘ç”µé‡</span>
                                    <span class="benefit-value" id="dailyPower">-- kWh</span>
                                </div>
                            </div>

                            <div class="benefit-item">
                                <div class="benefit-icon">
                                    <i class="fas fa-calendar-day"></i>
                                </div>
                                <div class="benefit-content">
                                    <span class="benefit-label">é¢„ä¼°æ—¥å‡æ”¶ç›Š</span>
                                    <span class="benefit-value" id="dailyIncome">-- å…ƒ</span>
                                </div>
                            </div>

                            <div class="benefit-item">
                                <div class="benefit-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div class="benefit-content">
                                    <span class="benefit-label">é¢„ä¼°æœˆå‡æ”¶ç›Š</span>
                                    <span class="benefit-value" id="monthlyIncome">-- å…ƒ</span>
                                </div>
                            </div>

                            <div class="benefit-item">
                                <div class="benefit-icon">
                                    <i class="fas fa-leaf"></i>
                                </div>
                                <div class="benefit-content">
                                    <span class="benefit-label">æ¯å¹´å‡å°‘ç¢³æ’æ”¾</span>
                                    <span class="benefit-value" id="carbonReduction">-- å…¬æ–¤</span>
                                </div>
                            </div>

                            <div class="benefit-item">
                                <div class="benefit-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="benefit-content">
                                    <span class="benefit-label">æŠ•èµ„å›æŠ¥å‘¨æœŸ</span>
                                    <span class="benefit-value" id="paybackPeriod">-- å¹´</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è¾…åŠ©å·¥å…·åŒº -->
            <div class="card tools-card">
                <h2 class="tools-title">
                    <i class="fas fa-tools"></i>
                    å®‰è£…è§’åº¦å°åŠ©æ‰‹
                </h2>
                
                <div class="tools-content">
                    <div class="tool-input-group">
                        <div>
                            <label for="latitude">
                                <i class="fas fa-globe"></i>
                                æ‚¨æ‰€åœ¨åœ°çš„çº¬åº¦
                            </label>
                            <input type="number" 
                                   id="latitude" 
                                   name="latitude" 
                                   step="0.1" 
                                   min="-90" 
                                   max="90" 
                                   placeholder="ä¾‹å¦‚ï¼š39.9ï¼ˆåŒ—äº¬çº¬åº¦ï¼‰"
                                   value="39.9">
                        </div>
                        <button type="button" class="btn-secondary" id="calculateAngleBtn">
                            <i class="fas fa-calculator"></i>
                            è®¡ç®—æœ€ä½³è§’åº¦
                        </button>
                    </div>
                    
                    <div class="tool-result">
                        <div class="result-icon">
                            <i class="fas fa-compass"></i>
                        </div>
                        <div class="result-text">
                            <span class="result-label">æ¨èå®‰è£…è§’åº¦ï¼š</span>
                            <span class="result-value" id="optimalAngle">-- åº¦</span>
                        </div>
                    </div>
                    
                    <div class="tool-tips">
                        <h4>
                            <i class="fas fa-lightbulb"></i>
                            è§’åº¦ä¼˜åŒ–æç¤º
                        </h4>
                        <ul>
                            <li>æœ€ä½³å®‰è£…è§’åº¦é€šå¸¸æ¥è¿‘å½“åœ°çº¬åº¦</li>
                            <li>å¤å­£å¯é€‚å½“å‡å°è§’åº¦ï¼Œå†¬å­£å¯é€‚å½“å¢å¤§è§’åº¦</li>
                            <li>å›ºå®šå®‰è£…ä¸€èˆ¬å–çº¬åº¦-10Â°åˆ°çº¬åº¦+10Â°ä¹‹é—´</li>
                            <li>å—å‘å®‰è£…æ•ˆæœæœ€ä½³ï¼Œåä¸œæˆ–åè¥¿ä¼šé™ä½æ•ˆç‡</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>

        <!-- é¡µè„š -->
        <footer class="footer">
            <p>&copy; 2024 å…‰ä¼å‘ç”µé‡ä¸æ•ˆç›Šåˆ†æç³»ç»Ÿ | åŸºäºæ•°æ®é©±åŠ¨çš„æ™ºèƒ½åˆ†æ</p>
        </footer>
    </div>

    <!-- JavaScriptä»£ç  -->
    <script>
        // å…¨å±€å˜é‡
        let powerChart = null;
        let isLoading = false;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ å…‰ä¼å‘ç”µé‡åˆ†æç³»ç»Ÿå·²å¯åŠ¨');
            
            // åˆå§‹åŒ–å›¾è¡¨
            initializePowerChart();
            
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            bindEventListeners();
            
            // æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
            showWelcomeMessage();
        });

        // åˆå§‹åŒ– Chart.js å›¾è¡¨æ¡†æ¶
        function initializePowerChart() {
            const ctx = document.getElementById('powerChart');
            
            if (!ctx) {
                console.error('âŒ æ‰¾ä¸åˆ°å›¾è¡¨ç”»å¸ƒå…ƒç´ ');
                return;
            }

            // é”€æ¯ç°æœ‰å›¾è¡¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            if (powerChart) {
                powerChart.destroy();
            }

            // åˆ›å»ºç©ºçš„å›¾è¡¨æ¡†æ¶
            powerChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [
                        '00:00', '01:00', '02:00', '03:00', '04:00', '05:00',
                        '06:00', '07:00', '08:00', '09:00', '10:00', '11:00',
                        '12:00', '13:00', '14:00', '15:00', '16:00', '17:00',
                        '18:00', '19:00', '20:00', '21:00', '22:00', '23:00'
                    ],
                    datasets: [{
                        label: 'å‘ç”µé‡ (kWh)',
                        data: new Array(24).fill(0), // åˆå§‹åŒ–ä¸ºå…¨é›¶
                        borderColor: '#0ea5e9',
                        backgroundColor: 'rgba(14, 165, 233, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: '#0ea5e9',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '24å°æ—¶å‘ç”µé‡é¢„æµ‹æ›²çº¿',
                            font: {
                                size: 16,
                                weight: 'bold'
                            },
                            color: '#1e293b'
                        },
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: {
                                    size: 12
                                },
                                color: '#64748b'
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0ea5e9',
                            borderWidth: 1,
                            cornerRadius: 8,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return `å‘ç”µé‡: ${context.parsed.y.toFixed(2)} kWh`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'æ—¶é—´',
                                color: '#64748b',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            ticks: {
                                color: '#64748b',
                                font: {
                                    size: 11
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'å‘ç”µé‡ (kWh)',
                                color: '#64748b',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                }
                            },
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            ticks: {
                                color: '#64748b',
                                font: {
                                    size: 11
                                },
                                callback: function(value) {
                                    return value.toFixed(1) + ' kWh';
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });

            console.log('âœ… å›¾è¡¨åˆå§‹åŒ–å®Œæˆ');
        }

        // ç»‘å®šæ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
        function bindEventListeners() {
            // ç»‘å®šé¢„æµ‹æŒ‰é’®äº‹ä»¶
            const predictForm = document.getElementById('predictionForm');
            if (predictForm) {
                predictForm.addEventListener('submit', handlePredictSubmit);
                console.log('âœ… é¢„æµ‹è¡¨å•äº‹ä»¶å·²ç»‘å®š');
            }

            // ç»‘å®šè§’åº¦è®¡ç®—æŒ‰é’®äº‹ä»¶
            const calculateAngleBtn = document.getElementById('calculateAngleBtn');
            if (calculateAngleBtn) {
                calculateAngleBtn.addEventListener('click', handleAngleCalculate);
                console.log('âœ… è§’åº¦è®¡ç®—æŒ‰é’®äº‹ä»¶å·²ç»‘å®š');
            }

            // ç»‘å®šè¾“å…¥æ¡†éªŒè¯äº‹ä»¶
            bindInputValidation();
        }

        // ç»‘å®šè¾“å…¥æ¡†éªŒè¯
        function bindInputValidation() {
            const inputs = document.querySelectorAll('input[type="number"]');
            
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    validateInput(this);
                });
                
                input.addEventListener('blur', function() {
                    validateInput(this);
                });
            });
        }

        // éªŒè¯è¾“å…¥æ¡†
        function validateInput(input) {
            const value = parseFloat(input.value);
            const min = parseFloat(input.min);
            const max = parseFloat(input.max);
            
            // ç§»é™¤ä¹‹å‰çš„é”™è¯¯æ ·å¼
            input.style.borderColor = '';
            
            // éªŒè¯èŒƒå›´
            if (!isNaN(value)) {
                if (!isNaN(min) && value < min) {
                    input.style.borderColor = '#ef4444';
                    showToast(`${input.previousElementSibling.textContent}ä¸èƒ½å°äº${min}`, 'warning');
                } else if (!isNaN(max) && value > max) {
                    input.style.borderColor = '#ef4444';
                    showToast(`${input.previousElementSibling.textContent}ä¸èƒ½å¤§äº${max}`, 'warning');
                }
            }
        }

        // å¤„ç†é¢„æµ‹è¡¨å•æäº¤
        async function handlePredictSubmit(e) {
            e.preventDefault();
            
            if (isLoading) {
                console.log('â³ æ­£åœ¨å¤„ç†ä¸­ï¼Œè¯·ç¨å€™...');
                return;
            }

            try {
                // è®¾ç½®åŠ è½½çŠ¶æ€
                setLoadingState(true);
                
                // è·å–è¾“å…¥æ•°æ®
                const formData = getFormData();
                
                // éªŒè¯æ•°æ®
                if (!validateFormData(formData)) {
                    return;
                }
                
                console.log('ğŸ“Š å¼€å§‹é¢„æµ‹è¯·æ±‚...', formData);
                
                // è°ƒç”¨é¢„æµ‹API
                const result = await callPredictAPI(formData);
                
                if (result.success) {
                    // æ›´æ–°å›¾è¡¨å’Œç»“æœæ˜¾ç¤º
                    updatePredictionResults(result.prediction);
                    showToast('é¢„æµ‹å®Œæˆï¼', 'success');
                } else {
                    throw new Error(result.error || 'é¢„æµ‹å¤±è´¥');
                }
                
            } catch (error) {
                console.error('âŒ é¢„æµ‹è¿‡ç¨‹å‡ºé”™:', error);
                showToast(`é¢„æµ‹å¤±è´¥: ${error.message}`, 'error');
                showErrorState();
            } finally {
                setLoadingState(false);
            }
        }

        // è°ƒç”¨é¢„æµ‹API
        async function callPredictAPI(formData) {
            try {
                // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®è¿›è¡Œé¢„æµ‹è®¡ç®—
                const prediction = simulatePrediction(formData);
                
                return {
                    success: true,
                    prediction: prediction
                };
            } catch (error) {
                return {
                    success: false,
                    error: error.message
                };
            }
        }

        // æ¨¡æ‹Ÿé¢„æµ‹è®¡ç®—
        function simulatePrediction(formData) {
            const { city, power, angle, electricity_price, system_cost } = formData;
            
            // åŸºç¡€å‘ç”µé‡è®¡ç®—ï¼ˆç®€åŒ–æ¨¡å‹ï¼‰
            const basePowerPerKW = 4.5; // æ¯kWæ—¥å‡å‘ç”µé‡
            const angleEfficiency = Math.cos((angle - 30) * Math.PI / 180 * 0.5); // è§’åº¦æ•ˆç‡
            const cityFactor = getCityFactor(city); // åŸå¸‚ç³»æ•°
            
            const dailyPower = power * basePowerPerKW * angleEfficiency * cityFactor;
            
            // ç”Ÿæˆ24å°æ—¶å‘ç”µé‡åˆ†å¸ƒ
            const hourlyPower = generateHourlyPower(dailyPower);
            
            // ç»æµæ•ˆç›Šè®¡ç®—
            const economic_benefits = calculateEconomicBenefits(
                dailyPower, electricity_price, system_cost, power
            );
            
            return {
                daily_power: dailyPower,
                hourly_power: hourlyPower,
                economic_benefits: economic_benefits,
                weather: {
                    city: city,
                    temperature: 25 + Math.random() * 10,
                    humidity: 50 + Math.random() * 30,
                    solar_radiation: 700 + Math.random() * 300,
                    weather_condition: 'sunny',
                    simulated: true
                },
                system_info: {
                    power_capacity: power,
                    installation_angle: angle,
                    electricity_price: electricity_price,
                    system_cost: system_cost
                },
                timestamp: new Date().toLocaleString()
            };
        }

        // è·å–åŸå¸‚ç³»æ•°
        function getCityFactor(city) {
            const cityFactors = {
                'åŒ—äº¬': 1.0,
                'ä¸Šæµ·': 0.9,
                'å¹¿å·': 1.1,
                'æ·±åœ³': 1.1,
                'æˆéƒ½': 0.8,
                'è¥¿å®‰': 1.0,
                'æ­å·': 0.9,
                'å—äº¬': 0.9,
                'æ­¦æ±‰': 0.85,
                'é‡åº†': 0.75
            };
            
            return cityFactors[city] || 0.9;
        }

        // ç”Ÿæˆ24å°æ—¶å‘ç”µé‡åˆ†å¸ƒ
        function generateHourlyPower(dailyTotal) {
            // æ ‡å‡†åŒ–çš„å‘ç”µåˆ†å¸ƒæ›²çº¿
            const hourlyFactors = [
                0.0, 0.0, 0.0, 0.0, 0.0, 0.0,  // 0-5ç‚¹
                0.05, 0.15, 0.30, 0.50, 0.70, 0.85,  // 6-11ç‚¹
                1.00, 0.95, 0.85, 0.70, 0.50, 0.30,  // 12-17ç‚¹
                0.15, 0.05, 0.0, 0.0, 0.0, 0.0   // 18-23ç‚¹
            ];
            
            // å½’ä¸€åŒ–
            const totalFactor = hourlyFactors.reduce((sum, factor) => sum + factor, 0);
            const normalizedFactors = hourlyFactors.map(f => f / totalFactor);
            
            // è®¡ç®—æ¯å°æ—¶å‘ç”µé‡
            return normalizedFactors.map(factor => dailyTotal * factor);
        }

        // è®¡ç®—ç»æµæ•ˆç›Š
        function calculateEconomicBenefits(daily_power, electricity_price, system_cost, power_capacity) {
            const daily_income = daily_power * electricity_price;
            const monthly_income = daily_income * 30;
            const annual_income = daily_income * 365;
            const annual_power = daily_power * 365;
            const carbon_reduction = annual_power * 0.785; // æ¯kWhå‡æ’0.785kg CO2
            const payback_period = annual_income > 0 ? system_cost / annual_income : Infinity;
            
            return {
                daily_power: Math.round(daily_power * 100) / 100,
                daily_income: Math.round(daily_income * 100) / 100,
                monthly_income: Math.round(monthly_income * 100) / 100,
                annual_income: Math.round(annual_income * 100) / 100,
                annual_power: Math.round(annual_power * 100) / 100,
                carbon_reduction: Math.round(carbon_reduction * 100) / 100,
                payback_period: payback_period === Infinity ? 'æ— æ³•å›æœ¬' : Math.round(payback_period * 10) / 10
            };
        }

        // è·å–è¡¨å•æ•°æ®
        function getFormData() {
            return {
                city: document.getElementById('city')?.value?.trim() || 'åŒ—äº¬',
                power: parseFloat(document.getElementById('power')?.value) || 5.0,
                angle: parseFloat(document.getElementById('angle')?.value) || 30,
                electricity_price: parseFloat(document.getElementById('electricity_price')?.value) || 0.5,
                system_cost: parseFloat(document.getElementById('system_cost')?.value) || 50000
            };
        }

        // éªŒè¯è¡¨å•æ•°æ®
        function validateFormData(data) {
            const validations = [
                { field: 'city', value: data.city, check: v => v && v.length > 0, message: 'è¯·è¾“å…¥åŸå¸‚åç§°' },
                { field: 'power', value: data.power, check: v => v > 0 && v <= 10000, message: 'å…‰ä¼æ¿åŠŸç‡å¿…é¡»åœ¨0.1-10000kWä¹‹é—´' },
                { field: 'angle', value: data.angle, check: v => v >= 0 && v <= 90, message: 'å®‰è£…è§’åº¦å¿…é¡»åœ¨0-90åº¦ä¹‹é—´' },
                { field: 'electricity_price', value: data.electricity_price, check: v => v > 0 && v <= 5, message: 'ç”µä»·å¿…é¡»åœ¨0.1-5å…ƒ/åº¦ä¹‹é—´' },
                { field: 'system_cost', value: data.system_cost, check: v => v >= 1000 && v <= 10000000, message: 'ç³»ç»Ÿæˆæœ¬å¿…é¡»åœ¨1000-10000000å…ƒä¹‹é—´' }
            ];
            
            for (const validation of validations) {
                if (!validation.check(validation.value)) {
                    showToast(validation.message, 'warning');
                    document.getElementById(validation.field)?.focus();
                    return false;
                }
            }
            
            return true;
        }

        // æ›´æ–°é¢„æµ‹ç»“æœ
        function updatePredictionResults(prediction) {
            // æ›´æ–°å›¾è¡¨
            updatePowerChart(prediction.hourly_power);
            
            // æ›´æ–°ç»æµæ•ˆç›Šæ•°æ®
            updateEconomicBenefits(prediction.economic_benefits);
            
            // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
            showSuccessState();
        }

        // æ›´æ–°å‘ç”µé‡å›¾è¡¨
        function updatePowerChart(hourlyPower) {
            if (!powerChart || !hourlyPower) {
                console.error('âŒ å›¾è¡¨æˆ–æ•°æ®ä¸å¯ç”¨');
                return;
            }
            
            try {
                // æ›´æ–°æ•°æ®
                powerChart.data.datasets[0].data = hourlyPower;
                
                // åŠ¨æ€è°ƒæ•´Yè½´æœ€å¤§å€¼
                const maxPower = Math.max(...hourlyPower);
                powerChart.options.scales.y.max = Math.ceil(maxPower * 1.1 * 10) / 10;
                
                // é‡ç»˜å›¾è¡¨
                powerChart.update('active');
                
                console.log('âœ… å›¾è¡¨æ›´æ–°å®Œæˆ');
                
                // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
                const totalPower = hourlyPower.reduce((sum, power) => sum + power, 0);
                const peakPower = Math.max(...hourlyPower);
                const peakHour = hourlyPower.indexOf(peakPower);
                
                console.log(`ğŸ“Š å‘ç”µç»Ÿè®¡: æ—¥æ€»é‡=${totalPower.toFixed(2)}kWh, å³°å€¼=${peakPower.toFixed(2)}kWh@${peakHour}:00`);
                
            } catch (error) {
                console.error('âŒ å›¾è¡¨æ›´æ–°å¤±è´¥:', error);
            }
        }

        // æ›´æ–°ç»æµæ•ˆç›Šæ˜¾ç¤º
        function updateEconomicBenefits(benefits) {
            const benefitElements = {
                'dailyPower': benefits.daily_power + ' kWh',
                'dailyIncome': benefits.daily_income + ' å…ƒ',
                'monthlyIncome': benefits.monthly_income + ' å…ƒ',
                'carbonReduction': benefits.carbon_reduction + ' å…¬æ–¤',
                'paybackPeriod': benefits.payback_period + ' å¹´'
            };
            
            Object.entries(benefitElements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) {
                    // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                    element.style.opacity = '0';
                    setTimeout(() => {
                        element.textContent = value;
                        element.style.opacity = '1';
                    }, 300);
                }
            });
            
            console.log('âœ… ç»æµæ•ˆç›Šæ•°æ®æ›´æ–°å®Œæˆ');
        }

        // å¤„ç†è§’åº¦è®¡ç®—
        async function handleAngleCalculate() {
            try {
                const latitudeInput = document.getElementById('latitude');
                const latitude = parseFloat(latitudeInput?.value);
                
                // éªŒè¯çº¬åº¦
                if (isNaN(latitude) || latitude < -90 || latitude > 90) {
                    showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„çº¬åº¦å€¼ï¼ˆ-90åˆ°90åº¦ä¹‹é—´ï¼‰', 'warning');
                    latitudeInput?.focus();
                    return;
                }
                
                console.log(`ğŸ“ è®¡ç®—æœ€ä½³è§’åº¦ï¼Œçº¬åº¦: ${latitude}Â°`);
                
                // è®¾ç½®æŒ‰é’®åŠ è½½çŠ¶æ€
                const button = document.getElementById('calculateAngleBtn');
                const originalHTML = button?.innerHTML;
                if (button) {
                    button.disabled = true;
                    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> è®¡ç®—ä¸­...';
                }
                
                // æ¨¡æ‹Ÿè®¡ç®—å»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // è®¡ç®—æœ€ä½³è§’åº¦
                const optimalAngle = calculateOptimalAngle(latitude);
                
                // æ›´æ–°æ¨èè§’åº¦æ˜¾ç¤º
                updateOptimalAngle(optimalAngle);
                showToast('è§’åº¦è®¡ç®—å®Œæˆï¼', 'success');
                
            } catch (error) {
                console.error('âŒ è§’åº¦è®¡ç®—å‡ºé”™:', error);
                showToast(`è§’åº¦è®¡ç®—å¤±è´¥: ${error.message}`, 'error');
            } finally {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                const button = document.getElementById('calculateAngleBtn');
                if (button) {
                    button.disabled = false;
                    button.innerHTML = '<i class="fas fa-calculator"></i> è®¡ç®—æœ€ä½³è§’åº¦';
                }
            }
        }

        // è®¡ç®—æœ€ä½³å®‰è£…è§’åº¦
        function calculateOptimalAngle(latitude) {
            const absLatitude = Math.abs(latitude);
            
            // åŸºæœ¬å…¬å¼ï¼šæœ€ä½³è§’åº¦é€šå¸¸æ¥è¿‘çº¬åº¦å€¼
            let optimalAngle;
            
            if (absLatitude < 25) {
                // ä½çº¬åº¦åœ°åŒº
                optimalAngle = absLatitude + 5;
            } else if (absLatitude > 45) {
                // é«˜çº¬åº¦åœ°åŒº
                optimalAngle = absLatitude - 10;
            } else {
                // ä¸­çº¬åº¦åœ°åŒº
                optimalAngle = absLatitude;
            }
            
            // é™åˆ¶è§’åº¦èŒƒå›´åœ¨5-60åº¦ä¹‹é—´
            optimalAngle = Math.max(5, Math.min(60, optimalAngle));
            
            return Math.round(optimalAngle * 10) / 10;
        }

        // æ›´æ–°æœ€ä½³è§’åº¦æ˜¾ç¤º
        function updateOptimalAngle(angle) {
            const angleElement = document.getElementById('optimalAngle');
            if (angleElement) {
                // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                angleElement.style.opacity = '0';
                setTimeout(() => {
                    angleElement.textContent = angle + ' åº¦';
                    angleElement.style.opacity = '1';
                }, 300);
            }
        }

        // è®¾ç½®åŠ è½½çŠ¶æ€
        function setLoadingState(loading) {
            isLoading = loading;
            const button = document.getElementById('predictBtn');
            
            if (button) {
                if (loading) {
                    button.disabled = true;
                    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> é¢„æµ‹ä¸­...';
                } else {
                    button.disabled = false;
                    button.innerHTML = '<i class="fas fa-chart-line"></i> å¼€å§‹é¢„æµ‹';
                }
            }
            
            // æ·»åŠ åŠ è½½æ ·å¼åˆ°ç»“æœåŒºåŸŸ
            const resultCard = document.querySelector('.result-card');
            if (resultCard) {
                if (loading) {
                    resultCard.classList.add('loading');
                } else {
                    resultCard.classList.remove('loading');
                }
            }
        }

        // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
        function showSuccessState() {
            const resultCard = document.querySelector('.result-card');
            if (resultCard) {
                resultCard.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    resultCard.style.transform = 'scale(1)';
                }, 300);
            }
        }

        // æ˜¾ç¤ºé”™è¯¯çŠ¶æ€
        function showErrorState() {
            // é‡ç½®å›¾è¡¨ä¸ºç©ºçŠ¶æ€
            if (powerChart) {
                powerChart.data.datasets[0].data = new Array(24).fill(0);
                powerChart.update();
            }
            
            // é‡ç½®ç»æµæ•ˆç›Šæ˜¾ç¤º
            const benefitIds = ['dailyPower', 'dailyIncome', 'monthlyIncome', 'carbonReduction', 'paybackPeriod'];
            benefitIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = '-- ';
                }
            });
        }

        // æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
        function showWelcomeMessage() {
            console.log('ğŸŒ æ¬¢è¿ä½¿ç”¨å…‰ä¼å‘ç”µé‡ä¸æ•ˆç›Šåˆ†æç³»ç»Ÿï¼');
            console.log('ğŸ’¡ ä½¿ç”¨æç¤ºï¼š');
            console.log('   1. å¡«å†™ç³»ç»Ÿå‚æ•°');
            console.log('   2. ç‚¹å‡»"å¼€å§‹é¢„æµ‹"è·å–å‘ç”µé‡åˆ†æ');
            console.log('   3. ä½¿ç”¨"è§’åº¦å°åŠ©æ‰‹"ä¼˜åŒ–å®‰è£…è§’åº¦');
        }

        // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        function showToast(message, type = 'info') {
            // åˆ›å»ºæç¤ºå…ƒç´ 
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <div class="toast-content">
                    <i class="fas ${getToastIcon(type)}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            // æ·»åŠ åˆ°é¡µé¢
            document.body.appendChild(toast);
            
            // æ˜¾ç¤ºåŠ¨ç”»
            setTimeout(() => toast.classList.add('show'), 100);
            
            // è‡ªåŠ¨éšè—
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
            
            console.log(`${getToastIcon(type)} ${message}`);
        }

        // è·å–æç¤ºå›¾æ ‡
        function getToastIcon(type) {
            const icons = {
                'success': 'fa-check-circle',
                'error': 'fa-exclamation-circle',
                'warning': 'fa-exclamation-triangle',
                'info': 'fa-info-circle'
            };
            return icons[type] || icons['info'];
        }

        // å·¥å…·å‡½æ•°ï¼šæ ¼å¼åŒ–æ•°å­—
        function formatNumber(num, decimals = 2) {
            return Number(num).toLocaleString('zh-CN', {
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals
            });
        }

        // å¯¼å‡ºå‡½æ•°ä¾›è°ƒè¯•ä½¿ç”¨
        if (typeof window !== 'undefined') {
            window.solarApp = {
                updatePowerChart,
                updateEconomicBenefits,
                handlePredictSubmit,
                handleAngleCalculate,
                showToast,
                formatNumber
            };
        }
    </script>
</body>
</html>
